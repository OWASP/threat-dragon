{
  "version": "2.3.0",
  "summary": {
    "title": "URL shortener (Engineer 4)",
    "owner": "Engineer 4",
    "description": "The URL Shortener Service aims to provide a simple and efficient way for users to convert long URLs into short, easily shareable URLs. The service ensures functionality, reliability, and security while interacting with users and handling their data.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "URL Shortener Service Architecture",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 410,
              "y": 60
            },
            "size": {
              "width": 690,
              "height": 370
            },
            "attrs": {
              "headerText": {
                "text": "URL Shortener Service"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "b830597f-432f-4c75-a688-8722ce7f1585",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "URL Shortener Service",
              "description": "URL Shortener Service trust boundary",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 190,
              "y": 147
            },
            "size": {
              "width": 170,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Human User / Service"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "66177acb-3c56-41a6-b074-8d27ddaa5fd1"
                },
                {
                  "group": "right",
                  "id": "3184d596-f519-4d1f-a367-b7f9373800e9"
                },
                {
                  "group": "bottom",
                  "id": "de8846ed-e663-451d-b5bc-1da382ba0ab1"
                },
                {
                  "group": "left",
                  "id": "1930ecd5-a025-45c3-ad83-164b2dae282e"
                }
              ]
            },
            "id": "3ebe0ef2-2820-4e4d-8eb4-184714e6cf67",
            "data": {
              "type": "tm.Actor",
              "name": "Human User / Service",
              "description": "External services or human users may interact with the API for bulk operations or integrations.",
              "outOfScope": true,
              "reasonOutOfScope": "Incoming requests outside of application scope",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 760,
              "y": 300
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Redirect URL"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "fafd2196-5021-4d16-8862-1ee8bd4ddee2"
                },
                {
                  "group": "right",
                  "id": "2a1491c5-5ebd-402b-a6b2-99891ff33014"
                },
                {
                  "group": "bottom",
                  "id": "459d762f-09e6-4907-ad51-7555011ba5b1"
                },
                {
                  "group": "left",
                  "id": "c220992f-b2af-4fab-a1c5-bdd9c6eb49cc"
                }
              ]
            },
            "id": "602a3f85-c6bc-48db-9230-9cb402fdc6f0",
            "data": {
              "type": "tm.Process",
              "name": "Redirect URL",
              "description": "Enables users to resolve short URLs and be redirected to the corresponding long URLs via a dedicated API.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 740,
              "y": 100
            },
            "size": {
              "width": 110,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Shorten URL"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "52678d81-4e33-4d24-8012-fa8a0813d71b"
                },
                {
                  "group": "right",
                  "id": "29ec233a-09f7-41a4-8354-daa90a694075"
                },
                {
                  "group": "bottom",
                  "id": "c51d1a4e-f6ad-4a6d-bef0-fdaf093b8da4"
                },
                {
                  "group": "left",
                  "id": "bdc1ab71-276b-4da6-a2c1-bc1123910581"
                }
              ]
            },
            "id": "1f9260a0-bd64-49d7-a839-58e5e43948dc",
            "data": {
              "type": "tm.Process",
              "name": "Shorten URL",
              "description": "Allows users to submit long URLs and receive shortened URLs via a dedicated API.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 944.9999999999993,
              "y": 215
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "URL Mappings Database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 6,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "741ce612-1b22-483d-a925-8a9057cbd061"
                },
                {
                  "group": "right",
                  "id": "75dc5da8-f579-4255-b9c3-0004f800a1ad"
                },
                {
                  "group": "bottom",
                  "id": "d98efebf-9947-4cc1-bec2-78a4780fa001"
                },
                {
                  "group": "left",
                  "id": "4eaa09cc-5c29-4f20-959d-7772b2b9576f"
                }
              ]
            },
            "id": "afe966da-e79b-4415-8c3b-c8b7f3bfdb1c",
            "data": {
              "type": "tm.Store",
              "name": "URL Mappings Database",
              "description": "Data store containing the mappings between short URLs and their corresponding long URLs.\n\nDATA STORED: Long URL, Short URL, UserID, CreationDate",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "0a1e0a1d-51cd-4f87-89a7-2ca8984e6a0b",
                  "title": "No backup in case of data loss",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "In case of no backup in place, the information from database may be lost",
                  "mitigation": "Perform regular backups, use solutions from cloud vendors like AWS Backup",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 3
              }
            }
          },
          {
            "position": {
              "x": 920,
              "y": 480
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Original URL"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "15c91bea-d6e5-4b06-a493-c9ec30a4c89f"
                },
                {
                  "group": "right",
                  "id": "df666280-3cb3-49d2-abc3-f4a01e54520d"
                },
                {
                  "group": "bottom",
                  "id": "28bd50cf-f684-43aa-9036-d6c0d215f419"
                },
                {
                  "group": "left",
                  "id": "b3bbc9b5-cef3-475f-8b7b-ad333ce15679"
                }
              ]
            },
            "id": "2c0500fb-85fa-4497-908a-61b1ea2e09f4",
            "data": {
              "type": "tm.Actor",
              "name": "Original URL",
              "description": "Destination server of the original URL",
              "outOfScope": true,
              "reasonOutOfScope": "Original URL not in scope of URL shortener application",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 507,
              "y": 237
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "API Server"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 8,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "7dbe3e0d-ab4a-4360-a2fb-2add6169cbf3"
                },
                {
                  "group": "right",
                  "id": "d8de9bd5-2974-4fa3-84fc-b7e0ad1342cf"
                },
                {
                  "group": "bottom",
                  "id": "6c705c33-2b76-4d50-91cc-144ffb35b1e1"
                },
                {
                  "group": "left",
                  "id": "78916a58-2956-4fd5-9adf-06643722225c"
                }
              ]
            },
            "id": "23c4d6cc-6e67-47cd-855d-610b8e390d5f",
            "data": {
              "type": "tm.Process",
              "name": "API Server",
              "description": "The API Server is the central component of the URL Shortener Service. It manages all interactions with users and external services, handling requests for both shortening URLs and redirecting from short URLs to their original long URLs. ",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "0d5f37a3-a8b2-4458-ba85-128ecfa5412d",
                  "title": "Ransomware attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Malicious link may lead to downloading a malicious file",
                  "mitigation": "Input validation and filtering",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "178206d4-5737-4f4a-ba04-4a31cd39ceb3",
                  "title": "Missing access controls for POST, PUT and DELETE",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "Accessing API with missing access controls for POST, PUT and DELETE.",
                  "mitigation": "Use API Gateway and I AM roles?",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                },
                {
                  "id": "fd5fbf3a-20f4-4b7b-a02b-4db9164b46a7",
                  "title": "APIs are no monitored for suspicious activity",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "No monitoring for suspicious activity ",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 1,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 497,
              "y": 100
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Hashed API keys"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 9,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "484fe139-452b-4c41-8809-50a2b954c6f3"
                },
                {
                  "group": "right",
                  "id": "57b74329-f609-4944-abc6-c7c14b6610e4"
                },
                {
                  "group": "bottom",
                  "id": "c0452ca1-5ebd-414a-90cd-c8dda7459fc8"
                },
                {
                  "group": "left",
                  "id": "b99ed450-3033-4001-8975-1a1186107c77"
                }
              ]
            },
            "id": "dd3ca2fb-9929-4ad2-bd6d-ec06b824924a",
            "data": {
              "type": "tm.Store",
              "name": "Hashed API keys",
              "description": "Database containing hashed API keys for authentication purposes.\n\nDATA STORED: Hashed API Key, UserID",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": [
                {
                  "id": "96c46f88-0a87-49ef-850d-8512bb2e0fbc",
                  "title": "Weak hashing algorithm",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Usage of weak hashing algorithm (MD5, SHA-1) that is easy to decrypt the information",
                  "mitigation": "Use more secure algorithms like SHA-2 or SHA-3",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "077501af-5d6e-4456-b5bb-4ea0cb722863",
                  "title": "No backup in case of data loss",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "In case of no backup in place, the information from database may be lost",
                  "mitigation": "Perform regular backups, use solutions from cloud vendors like AWS Backup",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Redirect Request",
              "description": "The user submits a short URL to the API and gets redirected to the original Long URL.\n\nDATA EXCHANGED: Short URL, Long URL",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Redirect Request"
            ],
            "id": "c01e0e5d-2f52-4b05-a659-58b854fb8b54",
            "source": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "target": {
              "cell": "602a3f85-c6bc-48db-9230-9cb402fdc6f0"
            },
            "vertices": [
              {
                "x": 640,
                "y": 380
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Redirect User to URL",
              "description": "The user is redirected to the Long URL.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Redirect User to URL"
            ],
            "id": "07f08d6d-e984-4d14-9d25-36ad24b230bd",
            "source": {
              "cell": "602a3f85-c6bc-48db-9230-9cb402fdc6f0"
            },
            "target": {
              "cell": "2c0500fb-85fa-4497-908a-61b1ea2e09f4",
              "port": "15c91bea-d6e5-4b06-a493-c9ec30a4c89f"
            },
            "vertices": [
              {
                "x": 930,
                "y": 420
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Fetch API credentials",
              "description": "Hashed API keys are pulled to authenticate the user before performing any operation.\n\nDATA EXCHANGED: Hashed API key",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "244c1f55-db04-4932-891b-ed9f10b4c78e",
                  "title": "Weak TLS algorithm",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Weak TLS algorithms (TLS 1.0, 1.1, 1.2 (maybe also can be mentioned)) don't provide secure communication and may allow modification of the transferred data",
                  "mitigation": "Use TLS 1.3",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Fetch API credentials"
            ],
            "id": "64b5c059-2c27-49ef-84e8-7e8ee050931f",
            "source": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "target": {
              "cell": "dd3ca2fb-9929-4ad2-bd6d-ec06b824924a"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Shorten Request",
              "description": "The user submits a long URL to the API for shortening.\n\nDATA EXCHANGED: Short URL, Long URL, UserID",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Shorten Request"
            ],
            "id": "e8d0a24f-858a-45bd-b447-06e07897128a",
            "source": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "target": {
              "cell": "1f9260a0-bd64-49d7-a839-58e5e43948dc",
              "port": "bdc1ab71-276b-4da6-a2c1-bc1123910581"
            },
            "vertices": [
              {
                "x": 710,
                "y": 240
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Store URL Mapping",
              "description": "The API Server processes the request for shortening a URL, generates a short URL, and stores the mapping between the short URL and the long URL in the URL Database.\n\nDATA EXCHANGED: Short URL, Long URL",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Store URL Mapping"
            ],
            "id": "0bcd6bca-360b-4f4e-a505-187195135022",
            "source": {
              "cell": "1f9260a0-bd64-49d7-a839-58e5e43948dc"
            },
            "target": {
              "cell": "afe966da-e79b-4415-8c3b-c8b7f3bfdb1c"
            },
            "vertices": [
              {
                "x": 960,
                "y": 150
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Retrieve Long URL",
              "description": "Long URL mapping is pulled from the database in order to redirect user.\n\nDATA EXCHANGED: Short URL, Long URL, UserID",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "42567528-9983-4862-9ab9-1e989dfdbe2e",
                  "title": "URL exposes session identifier",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "This may lead to cross-site scripting or  sniffing attack, steal the session ID and hijack the user's session. It may also raises privacy concerns",
                  "mitigation": "Use TLS (1.3), generate a long, random session",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 3,
                "denialOfService": 0
              }
            },
            "labels": [
              "Retrieve Long URL"
            ],
            "id": "23e310de-2c36-4478-85d2-4999137f6df3",
            "source": {
              "cell": "602a3f85-c6bc-48db-9230-9cb402fdc6f0"
            },
            "target": {
              "cell": "afe966da-e79b-4415-8c3b-c8b7f3bfdb1c"
            },
            "vertices": [
              {
                "x": 970,
                "y": 320
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "User Request",
              "description": "The User sends a request to the API Server to shorten a long URL or to get the redirect URL.\n\nDATA EXCHANGED: Long URL, Short URL, API key",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "96c46f88-0a87-49ef-850d-8512bb2e0fbc",
                  "title": "Unsafe link sent by an attacker",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Unsafe link may redirect to a malicious page (at the first sight this can look legitimate).\nAdditionally, there might be a file download after clicking the page",
                  "mitigation": "Hover over the link and see what appears in the preview - check if the link is the same\nInput validation and filtering",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "abb05ee8-e8fb-4726-83aa-7c1e64f45e0f",
                  "title": "Usage of compromised API keys",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker may use a compromised API keys that allow access",
                  "mitigation": "Rotate API keys on a regular basis",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                },
                {
                  "id": "2e124cbe-04e3-4078-9230-dbaf0bf292bf",
                  "title": "Parameter tampering",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Manipulation of parameters in URL",
                  "mitigation": "Input validation, usage of HTTPS protocol",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "4cf2745b-275e-4326-96b8-fc3cc67c5ea8",
                  "title": "URL exposes session identifier",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "This may lead to cross-site scripting or  sniffing attack, steal the session ID and hijack the user's session. It may also raises privacy concerns",
                  "mitigation": "Use TLS (1.3), generate a long, random session",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "d9e2f64c-ac02-44a5-af53-1861558162fd",
                  "title": "Sensitive data sends in URL",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Sensitive and authentication information like tokens and passwords can be send in the URL",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 5,
                "informationDisclosure": 2,
                "denialOfService": 1
              }
            },
            "labels": [
              "User Request"
            ],
            "id": "d6f0c600-c203-43af-80a3-3f9efb740b3e",
            "source": {
              "cell": "3ebe0ef2-2820-4e4d-8eb4-184714e6cf67"
            },
            "target": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "vertices": [
              {
                "x": 275,
                "y": 310
              },
              {
                "x": 370,
                "y": 310
              }
            ]
          }
        ]
      }
    ],
    "diagramTop": 1,
    "reviewer": "",
    "threatTop": 19
  }
}