{
  "version": "2.2.0",
  "summary": {
    "title": "URL shortener (Grzegorz Kmita)",
    "owner": "Grzegorz Kmita",
    "description": "The URL Shortener Service aims to provide a simple and efficient way for users to convert long URLs into short, easily shareable URLs. The service ensures functionality, reliability, and security while interacting with users and handling their data.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "URL Shortener Service Architecture",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 410,
              "y": 60
            },
            "size": {
              "width": 690,
              "height": 370
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "URL Shortener Service"
              }
            },
            "zIndex": -1,
            "id": "b830597f-432f-4c75-a688-8722ce7f1585",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "URL Shortener Service",
              "description": "URL Shortener Service trust boundary",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 190,
              "y": 147
            },
            "size": {
              "width": 170,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Human User / Service"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "id": "3ebe0ef2-2820-4e4d-8eb4-184714e6cf67",
            "data": {
              "type": "tm.Actor",
              "name": "Human User / Service",
              "description": "External services or human users may interact with the API for bulk operations or integrations.",
              "outOfScope": true,
              "reasonOutOfScope": "Incoming requests outside of application scope",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 750,
              "y": 290
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Redirect URL"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "id": "602a3f85-c6bc-48db-9230-9cb402fdc6f0",
            "data": {
              "type": "tm.Process",
              "name": "Redirect URL",
              "description": "Enables users to resolve short URLs and be redirected to the corresponding long URLs via a dedicated API.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "402987be-8280-4c46-9bad-a00102ca7110",
                  "title": "External connection",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can bypass the API server and connect directly to the URL shortener or URL redirect processes without authenticating.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "d1cf033a-5338-46eb-85dc-a60479c0ee01",
                  "title": "Unauthenticated link",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can connect to a server or peer over a link that isn’t authenticated (and encrypted).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 745,
              "y": 125
            },
            "size": {
              "width": 110,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Shorten URL"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "id": "1f9260a0-bd64-49d7-a839-58e5e43948dc",
            "data": {
              "type": "tm.Process",
              "name": "Shorten URL",
              "description": "Allows users to submit long URLs and receive shortened URLs via a dedicated API.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "f12b29c7-d844-422a-8428-880b50d88e95",
                  "title": "External connection",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "An attacker can bypass the API server and connect directly to the URL shortener or URL redirect processes without authenticating.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                },
                {
                  "id": "f225f051-d8cc-41c0-83b4-65fd2e439506",
                  "title": "Unauthenticated link",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can connect to a server or peer over a link that isn’t authenticated (and encrypted).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "b1fda1b6-e9f4-4a8d-8080-f0583d26c083",
                  "title": "Different validation paths",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "An attacker can force data through different validation paths which give different results.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 38,
                  "score": ""
                },
                {
                  "id": "3e86329c-b3c7-4433-b74b-f59305193a8b",
                  "title": "Malicious long URL",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "An attacker can provide a malicious long URL to be shortened to deceive other users unaware of the mapping.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 40,
                  "score": ""
                },
                {
                  "id": "2d302a68-83e0-488f-b853-dc8b7b7912ac",
                  "title": "Validated data still under attacker's control",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "An attacker can enter data that is checked while still under the attacker’s control and used later on the other side of a trust boundary",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 41,
                  "score": ""
                },
                {
                  "id": "4c2fe751-029a-498f-9409-16cb22928395",
                  "title": "Possible attacks with URLs",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "An attacker can try to craft a URL with injected scripts, causing a lot of different attacks, such as CSRF",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 42,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 5
              }
            }
          },
          {
            "position": {
              "x": 934.9999999999993,
              "y": 215
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "URL Mappings Database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 6,
            "id": "afe966da-e79b-4415-8c3b-c8b7f3bfdb1c",
            "data": {
              "type": "tm.Store",
              "name": "URL Mappings Database",
              "description": "Data store containing the mappings between short URLs and their corresponding long URLs.\n\nDATA STORED: Long URL, Short URL, UserID, CreationDate",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "adfd9382-ce35-4005-9df2-656f265e6906",
                  "title": "Too broad permissions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can write to some resource because permissions are granted to the world or there are no ACLs.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                },
                {
                  "id": "69207f0e-8564-4dd6-b06b-5c87b4a19e40",
                  "title": "Denying registering the mapping",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "An attacker can deny registering some mapping and there is no way to prove they didn't do that.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": ""
                },
                {
                  "id": "4564da74-491a-4cf8-9033-03fdaae0c940",
                  "title": "Information disclosure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker could read from the database and discover the mappings of other clients",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": ""
                },
                {
                  "id": "0f1f680f-8f9e-4bc9-a5bc-a01057ccee59",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": true,
                  "number": 39,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 902.4999999999993,
              "y": 470
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Original URL"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 7,
            "id": "2c0500fb-85fa-4497-908a-61b1ea2e09f4",
            "data": {
              "type": "tm.Actor",
              "name": "Original URL",
              "description": "Destination server of the original URL",
              "outOfScope": true,
              "reasonOutOfScope": "Original URL not in scope of URL shortener application",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 507,
              "y": 247
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "API Server"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 8,
            "id": "23c4d6cc-6e67-47cd-855d-610b8e390d5f",
            "data": {
              "type": "tm.Process",
              "name": "API Server",
              "description": "The API Server is the central component of the URL Shortener Service. It manages all interactions with users and external services, handling requests for both shortening URLs and redirecting from short URLs to their original long URLs. ",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "82bebd42-3e1a-4235-846d-e168f9cc36df",
                  "title": "Brute-force attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker could try one credential after another and there’s nothing to slow them down (online or offline).",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "85e123ed-cc82-4149-9793-f8d17422549f",
                  "title": "Anonymous connection",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can anonymously connect, because we expect authentication to be done at a higher level.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                },
                {
                  "id": "a49836f7-df73-4338-baa6-f2088bf6901e",
                  "title": "Re-connection inconsistency",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can spoof a server because identifiers aren’t stored on the client and checked for consistency on re-connection (that is, there’s no key persistence).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                },
                {
                  "id": "ca06c517-62ff-4d04-80e4-6a510472ed17",
                  "title": "Unauthenticated link",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can connect to a server or peer over a link that isn’t authenticated (and encrypted).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                },
                {
                  "id": "27fb6656-bb5e-44e5-bcf6-d7717fb2c602",
                  "title": "Credentials theft",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker could steal credentials stored on the server and reuse them (for example, a key is stored in a world readable file).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "f70f6826-e929-4924-918d-a98df5827a59",
                  "title": "Password reuse",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker who gets a password can reuse it (use stronger authenticators).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "8e3edbc4-a5f0-4b3d-8b53-02116406dac0",
                  "title": "Weaker or no authentication",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can choose to use weaker or no authentication.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "6ff91c88-4469-4427-8939-8a4923fdbdd2",
                  "title": "Old passwords disclosing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker could go after the way credentials are updated or recovered (account recovery doesn’t require disclosing the old password).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "b1b206fb-4f28-4840-9c55-3a29d88c07f7",
                  "title": "Default system passwords",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Your system ships with a default admin password and doesn’t force a change.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                },
                {
                  "id": "e7c30fbc-6ce0-4b4a-835d-b628c38b8751",
                  "title": "Different UserID",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker can authenticate properly and then use a different UserID to exfiltrate and disclose data they are not entitled to see. ",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "edeaf65b-1c4f-412b-9b5a-911970a90555",
                  "title": "Spreaded access control decisions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Your code makes access control decisions all over the place, rather than with a security kernel.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                },
                {
                  "id": "5ebb2134-534e-4851-a88b-c1aa96e7dca7",
                  "title": "Non-canonical names",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can bypass permissions because you don’t make names canonical before checking access permissions.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                },
                {
                  "id": "6d06dcda-f14b-40ad-ad30-98461177c955",
                  "title": "State information control",
                  "status": "NotApplicable",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can provide or control state information.",
                  "mitigation": "URL Shortener service is stateless",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "dee0a3fd-d893-4ca5-aec6-b8b1205706e5",
                  "title": "Parameter change after validation",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can change parameters over a trust boundary and after validation (for example, important parameters in a hidden field in HTML or passing a pointer to critical memory).",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                },
                {
                  "id": "fbde5fd2-f36f-4cd4-93ec-247abfb079ac",
                  "title": "Security information in the logs",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "A low privilege attacker can read interesting security information in the logs.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                },
                {
                  "id": "80e912af-e4c7-404a-9ee7-1abb55757209",
                  "title": "Common key confusing information in the logs",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "An attacker can use a shared key to authenticate as different principals, confusing the information in the logs.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "3b8a5a85-f286-4dfd-9242-4fb272281354",
                  "title": "Repudation attempt",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "An attacker can say “I didn’t do that,” and you would have no way to prove them wrong.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                },
                {
                  "id": "e21039ce-6af4-4afa-943b-9187ed89d5d5",
                  "title": "System has no logs",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The system has no logs.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                },
                {
                  "id": "411ea611-62c2-4a0e-9a82-08276e14f37e",
                  "title": "Error messeges with sensitive content",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker can see error messages with security sensitive content.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "5cf526ae-a8b6-4cd8-9a70-1422727dfcf7",
                  "title": "Request Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker can perform a lot of invalid API calls, and the server will have to process a large number of incorrect requests, possibly causing a crash.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 37,
                  "score": ""
                },
                {
                  "id": "b34b88f1-2253-4c1c-bc6e-c667fab10785",
                  "title": "Command injection",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "An attacker can inject a command that the system will run at a higher privilege level.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 44,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 10,
                "tampering": 5,
                "repudiation": 5,
                "informationDisclosure": 2,
                "denialOfService": 2,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 497,
              "y": 100
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Hashed API keys"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 9,
            "id": "dd3ca2fb-9929-4ad2-bd6d-ec06b824924a",
            "data": {
              "type": "tm.Store",
              "name": "Hashed API keys",
              "description": "Database containing hashed API keys for authentication purposes.\n\nDATA STORED: Hashed API Key, UserID",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": [
                {
                  "id": "523cbe3d-59d9-487b-b44e-f256553a5d88",
                  "title": "Too broad permissions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can write to some resource because permissions are granted to the world or there are no ACLs.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                },
                {
                  "id": "573ac38a-eeef-4a85-9536-9dee496a41b4",
                  "title": "Information disclosure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker could read from the database and discover API key hashes",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Redirect Request",
              "description": "The user submits a short URL to the API and gets redirected to the original Long URL.\n\nDATA EXCHANGED: Short URL, Long URL",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "c01e0e5d-2f52-4b05-a659-58b854fb8b54",
            "labels": [
              "Redirect Request"
            ],
            "source": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "target": {
              "cell": "602a3f85-c6bc-48db-9230-9cb402fdc6f0"
            },
            "vertices": [
              {
                "x": 640,
                "y": 380
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Redirect User to URL",
              "description": "The user is redirected to the Long URL.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "07f08d6d-e984-4d14-9d25-36ad24b230bd",
            "labels": [
              "Redirect User to URL"
            ],
            "source": {
              "cell": "602a3f85-c6bc-48db-9230-9cb402fdc6f0"
            },
            "target": {
              "x": 950,
              "y": 470
            },
            "vertices": [
              {
                "x": 930,
                "y": 420
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Retrieve Long URL",
              "description": "Long URL mapping is pulled from the database in order to redirect user.\n\nDATA EXCHANGED: Short URL, Long URL, UserID",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "23e310de-2c36-4478-85d2-4999137f6df3",
            "labels": [
              "Retrieve Long URL"
            ],
            "source": {
              "cell": "602a3f85-c6bc-48db-9230-9cb402fdc6f0"
            },
            "target": {
              "cell": "afe966da-e79b-4415-8c3b-c8b7f3bfdb1c"
            },
            "vertices": [
              {
                "x": 970,
                "y": 320
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Shorten Request",
              "description": "The user submits a long URL to the API for shortening.\n\nDATA EXCHANGED: Short URL, Long URL, UserID",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e8d0a24f-858a-45bd-b447-06e07897128a",
            "labels": [
              "Shorten Request"
            ],
            "source": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "target": {
              "cell": "1f9260a0-bd64-49d7-a839-58e5e43948dc"
            },
            "vertices": [
              {
                "x": 710,
                "y": 240
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Fetch API credentials",
              "description": "Hashed API keys are pulled to authenticate the user before performing any operation.\n\nDATA EXCHANGED: Hashed API key",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "876e7fd4-da5a-4ba7-92ce-828de5d79c63",
                  "title": "Data modification",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can modify data in transit while an API key is saved in the database",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                },
                {
                  "id": "fe45e12a-6458-43c0-ae13-9e7f5a3787de",
                  "title": "Data disclosure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker can read content because messages (for example, an email or HTTP cookie) aren’t encrypted even if the channel is encrypted.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "id": "64b5c059-2c27-49ef-84e8-7e8ee050931f",
            "labels": [
              "Fetch API credentials"
            ],
            "source": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "target": {
              "cell": "dd3ca2fb-9929-4ad2-bd6d-ec06b824924a"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Store URL Mapping",
              "description": "The API Server processes the request for shortening a URL, generates a short URL, and stores the mapping between the short URL and the long URL in the URL Database.\n\nDATA EXCHANGED: Short URL, Long URL",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "3c2e7130-595c-408f-b986-70ad98eee9ca",
                  "title": "Data disclosure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "THIS THREAT APPLIES TO ALL DATA FLOWS INSIDE THE TRUST BOUNDARY\nAn attacker can read content because messages (for example, an email or HTTP cookie) aren’t encrypted even if the channel is encrypted.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": ""
                },
                {
                  "id": "b4de4a99-85b7-4dc6-9fdb-fca9218bd0ec",
                  "title": "Data manipulation",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "THIS THREAT APPLIES TO ALL DATA FLOWS INSIDE THE TRUST BOUNDARY\nAn attacker can modify content of data flow while it's being transferred to another process.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "id": "0bcd6bca-360b-4f4e-a505-187195135022",
            "labels": [
              "Store URL Mapping"
            ],
            "source": {
              "cell": "1f9260a0-bd64-49d7-a839-58e5e43948dc"
            },
            "target": {
              "cell": "afe966da-e79b-4415-8c3b-c8b7f3bfdb1c"
            },
            "vertices": [
              {
                "x": 960,
                "y": 150
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "User Request",
              "description": "The User sends a request to the API Server to shorten a long URL or to get the redirect URL.\n\nDATA EXCHANGED: Long URL, Short URL, API key",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "b18f23ab-7fd9-4b72-9216-4c8c77be6b85",
                  "title": "Data manipulation",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can manipulate data because there’s no integrity protection for data on the network.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                },
                {
                  "id": "88d165ef-e789-43c4-9808-46f1039244f0",
                  "title": "Lack of data flow encryption",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker can read content because messages (for example, an email or HTTP cookie) aren’t encrypted even if the channel is encrypted.",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "id": "d6f0c600-c203-43af-80a3-3f9efb740b3e",
            "labels": [
              "User Request"
            ],
            "source": {
              "cell": "3ebe0ef2-2820-4e4d-8eb4-184714e6cf67"
            },
            "target": {
              "cell": "23c4d6cc-6e67-47cd-855d-610b8e390d5f"
            },
            "vertices": [
              {
                "x": 275,
                "y": 310
              },
              {
                "x": 370,
                "y": 310
              }
            ]
          }
        ]
      }
    ],
    "diagramTop": 1,
    "reviewer": "",
    "threatTop": 44
  }
}